diff -ruN trafficserver-6.1.1.orig/plugins/experimental/ts_lua/ts_lua_cached_response.c trafficserver-6.1.1/plugins/experimental/ts_lua/ts_lua_cached_response.c
--- trafficserver-6.1.1.orig/plugins/experimental/ts_lua/ts_lua_cached_response.c	2016-02-03 11:35:34.000000000 +0900
+++ trafficserver-6.1.1/plugins/experimental/ts_lua/ts_lua_cached_response.c	2016-05-10 23:19:03.941257946 +0900
@@ -185,9 +185,12 @@
 ts_lua_cached_response_get_headers(lua_State *L)
 {
   const char *name;
+  const char *old_value;
   const char *value;
   int name_len;
+  int old_value_len;
   int value_len;
+  luaL_Buffer buf;
   TSMLoc field_loc;
   TSMLoc next_field_loc;
 
@@ -204,11 +207,28 @@
   while (field_loc) {
     name = TSMimeHdrFieldNameGet(http_ctx->cached_response_bufp, http_ctx->cached_response_hdrp, field_loc, &name_len);
     if (name && name_len) {
-      value =
-        TSMimeHdrFieldValueStringGet(http_ctx->cached_response_bufp, http_ctx->cached_response_hdrp, field_loc, -1, &value_len);
       lua_pushlstring(L, name, name_len);
-      lua_pushlstring(L, value, value_len);
-      lua_rawset(L, -3);
+      lua_rawget(L, -2);
+      old_value = lua_tolstring(L, -1, &old_value_len);
+      if (old_value != NULL) {
+        lua_pushlstring(L, name, name_len);
+
+        luaL_buffinit(L, &buf);
+        luaL_addlstring(&buf, old_value, old_value_len);
+        luaL_addlstring(&buf, ", ", 2);
+        value =
+          TSMimeHdrFieldValueStringGet(http_ctx->cached_response_bufp, http_ctx->cached_response_hdrp, field_loc, -1, &value_len);
+        luaL_addlstring(&buf, value, value_len);
+        luaL_pushresult(&buf);
+
+        lua_rawset(L, -3);
+      } else {
+      value =
+          TSMimeHdrFieldValueStringGet(http_ctx->cached_response_bufp, http_ctx->cached_response_hdrp, field_loc, -1, &value_len);
+        lua_pushlstring(L, name, name_len);
+        lua_pushlstring(L, value, value_len);
+        lua_rawset(L, -3);
+      }
     }
 
     next_field_loc = TSMimeHdrFieldNext(http_ctx->cached_response_bufp, http_ctx->cached_response_hdrp, field_loc);
diff -ruN trafficserver-6.1.1.orig/plugins/experimental/ts_lua/ts_lua_client_request.c trafficserver-6.1.1/plugins/experimental/ts_lua/ts_lua_client_request.c
--- trafficserver-6.1.1.orig/plugins/experimental/ts_lua/ts_lua_client_request.c	2016-02-03 11:35:34.000000000 +0900
+++ trafficserver-6.1.1/plugins/experimental/ts_lua/ts_lua_client_request.c	2016-05-10 23:21:05.693252259 +0900
@@ -231,9 +231,12 @@
 ts_lua_client_request_get_headers(lua_State *L)
 {
   const char *name;
+  const char *old_value;
   const char *value;
   int name_len;
+  int old_value_len;
   int value_len;
+  luaL_Buffer buf;
   TSMLoc field_loc;
   TSMLoc next_field_loc;
 
@@ -248,10 +251,26 @@
   while (field_loc) {
     name = TSMimeHdrFieldNameGet(http_ctx->client_request_bufp, http_ctx->client_request_hdrp, field_loc, &name_len);
     if (name && name_len) {
-      value = TSMimeHdrFieldValueStringGet(http_ctx->client_request_bufp, http_ctx->client_request_hdrp, field_loc, -1, &value_len);
       lua_pushlstring(L, name, name_len);
-      lua_pushlstring(L, value, value_len);
-      lua_rawset(L, -3);
+      lua_rawget(L, -2);
+      old_value = lua_tolstring(L, -1, &old_value_len);
+      if (old_value != NULL) {
+        lua_pushlstring(L, name, name_len);
+
+        luaL_buffinit(L, &buf);
+        luaL_addlstring(&buf, old_value, old_value_len);
+        luaL_addlstring(&buf, ", ", 2);
+        value = TSMimeHdrFieldValueStringGet(http_ctx->client_request_bufp, http_ctx->client_request_hdrp, field_loc, -1, &value_len);
+        luaL_addlstring(&buf, value, value_len);
+        luaL_pushresult(&buf);
+
+        lua_rawset(L, -3);
+      } else {
+				value = TSMimeHdrFieldValueStringGet(http_ctx->client_request_bufp, http_ctx->client_request_hdrp, field_loc, -1, &value_len);
+				lua_pushlstring(L, name, name_len);
+				lua_pushlstring(L, value, value_len);
+				lua_rawset(L, -3);
+			}
     }
 
     next_field_loc = TSMimeHdrFieldNext(http_ctx->client_request_bufp, http_ctx->client_request_hdrp, field_loc);
diff -ruN trafficserver-6.1.1.orig/plugins/experimental/ts_lua/ts_lua_client_response.c trafficserver-6.1.1/plugins/experimental/ts_lua/ts_lua_client_response.c
--- trafficserver-6.1.1.orig/plugins/experimental/ts_lua/ts_lua_client_response.c	2016-02-03 11:35:34.000000000 +0900
+++ trafficserver-6.1.1/plugins/experimental/ts_lua/ts_lua_client_response.c	2016-05-10 23:21:43.155250510 +0900
@@ -188,9 +188,12 @@
 ts_lua_client_response_get_headers(lua_State *L)
 {
   const char *name;
+  const char *old_value;
   const char *value;
   int name_len;
+  int old_value_len;
   int value_len;
+  luaL_Buffer buf;
   TSMLoc field_loc;
   TSMLoc next_field_loc;
 
@@ -207,11 +210,28 @@
   while (field_loc) {
     name = TSMimeHdrFieldNameGet(http_ctx->client_response_bufp, http_ctx->client_response_hdrp, field_loc, &name_len);
     if (name && name_len) {
-      value =
-        TSMimeHdrFieldValueStringGet(http_ctx->client_response_bufp, http_ctx->client_response_hdrp, field_loc, -1, &value_len);
       lua_pushlstring(L, name, name_len);
-      lua_pushlstring(L, value, value_len);
-      lua_rawset(L, -3);
+      lua_rawget(L, -2);
+      old_value = lua_tolstring(L, -1, &old_value_len);
+      if (old_value != NULL) {
+        lua_pushlstring(L, name, name_len);
+
+        luaL_buffinit(L, &buf);
+        luaL_addlstring(&buf, old_value, old_value_len);
+        luaL_addlstring(&buf, ", ", 2);
+        value =
+          TSMimeHdrFieldValueStringGet(http_ctx->client_response_bufp, http_ctx->client_response_hdrp, field_loc, -1, &value_len);
+        luaL_addlstring(&buf, value, value_len);
+        luaL_pushresult(&buf);
+
+        lua_rawset(L, -3);
+      } else {
+				value =
+					TSMimeHdrFieldValueStringGet(http_ctx->client_response_bufp, http_ctx->client_response_hdrp, field_loc, -1, &value_len);
+				lua_pushlstring(L, name, name_len);
+				lua_pushlstring(L, value, value_len);
+				lua_rawset(L, -3);
+			}
     }
 
     next_field_loc = TSMimeHdrFieldNext(http_ctx->client_response_bufp, http_ctx->client_response_hdrp, field_loc);
diff -ruN trafficserver-6.1.1.orig/plugins/experimental/ts_lua/ts_lua_server_request.c trafficserver-6.1.1/plugins/experimental/ts_lua/ts_lua_server_request.c
--- trafficserver-6.1.1.orig/plugins/experimental/ts_lua/ts_lua_server_request.c	2016-02-03 11:35:34.000000000 +0900
+++ trafficserver-6.1.1/plugins/experimental/ts_lua/ts_lua_server_request.c	2016-05-10 23:22:16.288248962 +0900
@@ -236,9 +236,12 @@
 ts_lua_server_request_get_headers(lua_State *L)
 {
   const char *name;
+  const char *old_value;
   const char *value;
   int name_len;
+  int old_value_len;
   int value_len;
+  luaL_Buffer buf;
   TSMLoc field_loc;
   TSMLoc next_field_loc;
 
@@ -255,10 +258,26 @@
   while (field_loc) {
     name = TSMimeHdrFieldNameGet(http_ctx->server_request_bufp, http_ctx->server_request_hdrp, field_loc, &name_len);
     if (name && name_len) {
-      value = TSMimeHdrFieldValueStringGet(http_ctx->server_request_bufp, http_ctx->server_request_hdrp, field_loc, -1, &value_len);
       lua_pushlstring(L, name, name_len);
-      lua_pushlstring(L, value, value_len);
-      lua_rawset(L, -3);
+      lua_rawget(L, -2);
+      old_value = lua_tolstring(L, -1, &old_value_len);
+      if (old_value != NULL) {
+        lua_pushlstring(L, name, name_len);
+
+        luaL_buffinit(L, &buf);
+        luaL_addlstring(&buf, old_value, old_value_len);
+        luaL_addlstring(&buf, ", ", 2);
+        value = TSMimeHdrFieldValueStringGet(http_ctx->server_request_bufp, http_ctx->server_request_hdrp, field_loc, -1, &value_len);
+        luaL_addlstring(&buf, value, value_len);
+        luaL_pushresult(&buf);
+
+        lua_rawset(L, -3);
+      } else {
+				value = TSMimeHdrFieldValueStringGet(http_ctx->server_request_bufp, http_ctx->server_request_hdrp, field_loc, -1, &value_len);
+				lua_pushlstring(L, name, name_len);
+				lua_pushlstring(L, value, value_len);
+				lua_rawset(L, -3);
+			}
     }
 
     next_field_loc = TSMimeHdrFieldNext(http_ctx->server_request_bufp, http_ctx->server_request_hdrp, field_loc);
diff -ruN trafficserver-6.1.1.orig/plugins/experimental/ts_lua/ts_lua_server_response.c trafficserver-6.1.1/plugins/experimental/ts_lua/ts_lua_server_response.c
--- trafficserver-6.1.1.orig/plugins/experimental/ts_lua/ts_lua_server_response.c	2016-02-03 11:35:34.000000000 +0900
+++ trafficserver-6.1.1/plugins/experimental/ts_lua/ts_lua_server_response.c	2016-05-10 23:22:50.046247385 +0900
@@ -87,9 +87,12 @@
 ts_lua_server_response_get_headers(lua_State *L)
 {
   const char *name;
+  const char *old_value;
   const char *value;
   int name_len;
+  int old_value_len;
   int value_len;
+  luaL_Buffer buf;
   TSMLoc field_loc;
   TSMLoc next_field_loc;
 
@@ -106,11 +109,28 @@
   while (field_loc) {
     name = TSMimeHdrFieldNameGet(http_ctx->server_response_bufp, http_ctx->server_response_hdrp, field_loc, &name_len);
     if (name && name_len) {
-      value =
-        TSMimeHdrFieldValueStringGet(http_ctx->server_response_bufp, http_ctx->server_response_hdrp, field_loc, -1, &value_len);
       lua_pushlstring(L, name, name_len);
-      lua_pushlstring(L, value, value_len);
-      lua_rawset(L, -3);
+      lua_rawget(L, -2);
+      old_value = lua_tolstring(L, -1, &old_value_len);
+      if (old_value != NULL) {
+        lua_pushlstring(L, name, name_len);
+
+        luaL_buffinit(L, &buf);
+        luaL_addlstring(&buf, old_value, old_value_len);
+        luaL_addlstring(&buf, ", ", 2);
+        value =
+          TSMimeHdrFieldValueStringGet(http_ctx->server_response_bufp, http_ctx->server_response_hdrp, field_loc, -1, &value_len);
+        luaL_addlstring(&buf, value, value_len);
+        luaL_pushresult(&buf);
+
+        lua_rawset(L, -3);
+      } else {
+				value =
+					TSMimeHdrFieldValueStringGet(http_ctx->server_response_bufp, http_ctx->server_response_hdrp, field_loc, -1, &value_len);
+				lua_pushlstring(L, name, name_len);
+				lua_pushlstring(L, value, value_len);
+				lua_rawset(L, -3);
+			}
     }
 
     next_field_loc = TSMimeHdrFieldNext(http_ctx->server_response_bufp, http_ctx->server_response_hdrp, field_loc);
